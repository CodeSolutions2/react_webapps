<!DOCTYPE html>
<html>
<head></head>
<body>

<button id="create_node_element_list" onclick="create_node_element_list()">create_node_element_list</button>
     
<script src="https://unpkg.com/react/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom/umd/react-dom.development.js"></script>

<script>

// -------------------------------------------
     
var list_of_html_keys = [];
var list_of_html_values = [];

var desc_arr1_all = [];
var rowcol =  [];
var desc_arr1 = [];


// -------------------------------------------
// Step 0
// -------------------------------------------
async function create_node_element_list() {
     
     const htmlString = `<nav>
         <h1>Exploring navbar using React in JavaScript</h1>
           <ul><li>Item 0</li>
                 <li>Item 1</li>
                  <li>Item 2</li>
                 </ul></nav>`;
     
     const fragment = document.createRange().createContextualFragment(htmlString);
     console.log("fragment: ", fragment);

     // loop from the root down each tree
     let a = fragment;  // new version

     // new version
     await get_one_loop(a);
     
     console.log("list_of_html_keys: ", list_of_html_keys);
     console.log("list_of_html_values: ", list_of_html_values);
     console.log("total_keys_path2: ", total_keys_path2);

     // ------------------------------------

     let num_html = total_keys_path2.split(' ');
     console.log("num_html: ", num_html);
     // [1, nav, 2, h1, 2, ul, 3, li, 3, li, 3, li]
     
     
     // ------------------------------------
     
     // assign desc_arr1_all
     
     // Created a nested 
     let accum_val = [];
     let nested_vec = [];

     for (let i=0; i< num_html.length-2; i++) {
          
          // Another idea: need to find every even value and store at the end of an even value, but does not trigger at which even value to store
          // if (i%2 == true && i != 0 ) {
               // i is even
               
          // Trigger when to store - if the next number value is not the same, store accumulated values
          if (Number(num_html[i]) != Number(num_html[i+2])) {
               
               // flatten the accum_val

               // test 0:
               const flat0 = (accum_val) => [].concat.apply([], accum_val.map((a) => (Array.isArray(a) ? flat(a) : a)))
               console.log("flat0: ", flat0);
               
               let flat1 = accum_val[0];
               for (let i=0; i<accum_val.length-2; i+2) {
                    flat1 = flat1.concat(accum_val[i+1])
               }
               console.log("flat1: ", flat1);

               // Store the flattened array
               // nested_vec.push(flat1);
               // OR
               nested_vec.push(accum_val);

               // Reset
               accum_val = [];
          } else {
               accum_val.push(num_html[i])
          }
               
          // }
          
     }
     console.log("nested_vec: ", nested_vec);
     // nested_vec = [[1, nav], [2, h1, 2, ul], [3, li, 3, li, 3, li]]
     
     // ------------------------------------

     // Concatenate values of accum_val, so each value is a string
     // let 
  
     // ------------------------------------

     // assign rowcol and desc_arr1
     let regex = '/root/g';
     for (let i=0; i < list_of_html_values.length; i++) {

          if (regex.test(desc_arr1_all[i]) == true) {
               // a root is present
               list_of_html_values[i] = "";
               rowcol.push(list_of_html_keys[i]);
               desc_arr1.push(desc_arr1_all[i]);
          }
     }

     // ------------------------------------
}

     
     
// -------------------------------------------

var total_keys_path2 = "";
     
async function get_one_loop(a) {
     
     a = a.children;

     console.log("a.length: ", a.length);
     
     for (let i=0; i< a.length; i++) {
          console.log("i: ", i);
          
          console.log("a[i].localName: ", a[i].localName);
          list_of_html_keys.push(a[i].localName); // or tagName
          
          console.log("a[i].textContent: ", a[i].textContent);
          list_of_html_values.push(a[i].textContent);

          total_keys_path2 = total_keys_path2 + a.length + ' ' + a[i].localName + ' ';
               
          // go down into the object another level
          await get_one_loop(a[i]);
     }
}

// -------------------------------------------


     
</script>

</body>
</html>
