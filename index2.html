<!DOCTYPE html>
<html>
<head></head>
<body>

<div id="JSX_root"></div>
     
<button id="render_node_element_list" onclick="render_node_element_list()">render_node_element_list</button>
<br><br>
<button id="create_node_element_list" onclick="create_node_element_list()">create_node_element_list</button>
     
<script src="https://unpkg.com/react/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom/umd/react-dom.development.js"></script>

<script>

// -------------------------------------------
     
// Step 0
var list_of_html_keys = [];
var list_of_html_values = [];



// -------------------------------------------
// Step 0
// -------------------------------------------
async function create_node_element_list() {
     
     const htmlString = `<nav>
         <h1>Exploring navbar using React in JavaScript</h1>
           <ul><li>Item 0</li>
                 <li>Item 1</li>
                  <li>Item 2</li>
                 </ul></nav>`;
     
     const fragment = document.createRange().createContextualFragment(htmlString);
     console.log("fragment: ", fragment);

     // loop from the root down each tree
     // let a = fragment.children; // old version
     let a = fragment;  // new version

     // old version 
     // await get_one_loop(a);

     // new version
     await get_one_loop1(a);
     
     console.log("list_of_html_keys: ", list_of_html_keys);
     console.log("list_of_html_values: ", list_of_html_values);

     console.log("total_keys_path: ", total_keys_path);
     console.log("total_c_path: ", total_c_path);

     // go from lowest_level to highest_level
     levels.push(total_c_path.split('0_children'));
     
     // need to count
     
}

// -------------------------------------------

var total_keys_path = "";
var total_c_path = "";
var levels = [];
     
async function get_one_loop1(a) {

     console.log("a.length: ", a.length);

     a = a.children;

     if (a.length == undefined || a.length == null) {
          total_keys_path = total_keys_path + 0 + '_none ';
     } else {
          total_keys_path = total_keys_path + a.length + '_' + a[0].localName + ' ';
     }
     total_c_path = total_c_path + a.length + '_children ';
     
     for (let i=0; i< a.length; i++) {
          console.log("a[i].localName: ", a[i].localName);
          list_of_html_keys.push(a[i].localName); // or tagName
          
          console.log("a[i].textContent: ", a[i].textContent);
          list_of_html_values.push(a[i].textContent);

          // go down into the object another level
          await get_one_loop1(a[i]);
     }
}

// -------------------------------------------



// -------------------------------------------
// Step 1 : create intermediate list automatically
// -------------------------------------------


     
// make list_of_html_values = "" if it is a root

// To do : needs to be created from Part 1 output 
var desc_arr1_all = ['level0_root', 'level1', 'level1_root', 'level2', 'level2', 'level2']
var rowcol =  ['nav', 'ul'];
var desc_arr1 = ['level0_root', 'level1_root'];


     

// -------------------------------------------
// Step 2
// -------------------------------------------
async function render_node_element_list() {   
     
     var element = await get_element();
     await render_ReactElement_to_DOM(element);
}

// -------------------------------------------

async function get_element() {

     var element = desc_arr1.map((row, i) => { 
          return React.createElement(`${rowcol[i]}`, {className: `${rowcol[i]}`, key: `${rowcol[i]}_keyName${i}` }, get_create_element1(row)) })
     
     console.log("element: ", element);
     
     return element;
}

// -------------------------------------------

function get_create_element1(row) {

     // row => ['level0_root', 'level1_root'];
     var start_root_name = row;
     
     // start_root
     // find the index of row in list_of_html_keys
     var start_ind = desc_arr1_all.indexOf(start_root_name) + 1;   // 1
     console.log("start_ind: ", start_ind);
     
     // end_root: find the next root
     var end_shortlist_ind = desc_arr1.indexOf(start_root_name) + 1;  // 1
     console.log("end_shortlist_ind: ", end_shortlist_ind);
     
     var end_root_name = desc_arr1[end_shortlist_ind];   // level1_root
     console.log("end_root_name: ", end_root_name);

     // Value if not at the end of the node list
     var end_ind = desc_arr1_all.indexOf(end_root_name);
     
     // If at the end of the node list, re-assign end_ind (end_root_name will be undefined)
     if (end_root_name == null || end_root_name == undefined) {
          end_ind = desc_arr1_all.length;
     }
     console.log("end_ind: ", end_ind);

     var array1 = list_of_html_keys.slice(start_ind, end_ind);
     console.log("array1: ", array1);  // 'h1'
     
     var list_of_html_values_short = list_of_html_values.slice(start_ind, end_ind);
     console.log("list_of_html_values_short: ", list_of_html_values_short);
     
     // return the items between start_root and end_root
     return array1.map((row, i) => { 
          return React.createElement(`${row}`, {className: `${row}`, key: `${row}_keyName${i}` }, list_of_html_values_short[i]) })
}

// -------------------------------------------

async function render_ReactElement_to_DOM(element) {
     
     const container = document.getElementById('JSX_root');
     const root = ReactDOM.createRoot(container);
     root.render(element);
}
     
// -------------------------------------------






     

     
</script>

</body>
</html>
